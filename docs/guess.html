<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–£–≥–∞–¥–∞–π –¥—Ä–æ–±—å ‚Äî Silvia üíú</title>
  <link rel="stylesheet" href="css/style.css">

<style>
  :root {
    --purple2: #3c096c;
    --purple4: #7b2cbf;
    --purple5: #9d4edd;
    --purple6: #c77dff;
    --purple7: #d4bfff;
    --light: #e0aaff;
    --dark: #10002b;
    --green: #80ff80;
    --red: #ff6b6b;
  }
  body {
    background: linear-gradient(120deg, var(--purple2), var(--purple4));
    color: var(--light);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;

    /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ */
    display: flex;
    justify-content: center;
    align-items: center; /* –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ */
    min-height: 100vh;
    margin: 0;
    padding-top: 70px; /* –æ—Ç—Å—Ç—É–ø –ø–æ–¥ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é —à–∞–ø–∫—É */
    user-select: none;
    flex-direction: column;
  }
  #header-placeholder {
    width: 100%;
    margin-bottom: 30px;
    position: fixed;
    top: 0;
    left: 0;
    background: linear-gradient(120deg, var(--purple2), var(--purple4));
    z-index: 1000;
  }
  .game-container {
    max-width: 420px;
    width: 100%;
    background: #2a2a2a;
    padding: 30px 25px;
    border-radius: 12px;
    box-shadow: 0 0 14px 4px rgba(199, 125, 255, 0.4);
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  h1 {
    color: var(--purple6);
    margin-bottom: 15px;
  }
  p {
    font-size: 1rem;
    margin-bottom: 25px;
    color: var(--light);
  }
  label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--purple6);
  }
  select, input[type="text"] {
    width: 100%;
    padding: 10px;
    font-size: 1.1rem;
    border-radius: 8px;
    border: none;
    margin-bottom: 20px;
    outline: none;
    text-align: center;
    background: #3b3b3b;
    color: var(--light);
  }
  .submit-btn {
    margin-top: 5px;
    padding: 12px 30px;
    font-size: 1.25rem;
    border: none;
    border-radius: 30px;
    background: linear-gradient(45deg, var(--purple6), var(--purple7));
    color: var(--dark);
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 0 10px #9d4edd;
    transition: background 0.3s ease;
  }
  .submit-btn:hover:not(:disabled) {
    background: linear-gradient(45deg, var(--purple5), var(--purple6));
  }
  .submit-btn:disabled {
    background: #555555;
    cursor: not-allowed;
    box-shadow: none;
  }
  .message {
    margin-top: 15px;
    font-weight: 700;
    min-height: 1.4em;
    font-size: 1.2rem;
    transition: color 0.3s ease;
  }
  .message.success {
    color: var(--green);
  }
  .message.error {
    color: var(--red);
  }
  .hint {
    margin: 12px 0 20px;
    font-style: italic;
    font-size: 1.1rem;
    min-height: 1.4em;
    color: var(--purple5);
  }
  .attempts {
    margin-top: 10px;
    font-weight: 600;
    color: var(--light);
  }

  /* –ê–Ω–∏–º–∞—Ü–∏—è –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –ø—Ä–∏ –ø–æ–±–µ–¥–µ */
  .confetti-piece {
    position: absolute;
    width: 8px;
    height: 8px;
    background-color: var(--purple6);
    opacity: 0;
    animation: confetti-fall 2s forwards;
  }
  @keyframes confetti-fall {
    0% {
      opacity: 1;
      transform: translateY(0) rotate(0deg);
    }
    100% {
      opacity: 0;
      transform: translateY(200px) rotate(360deg);
    }
  }
</style>
</head>
<body>

<!-- –®–∞–ø–∫–∞ -->
<header id="header-placeholder"></header>

<div class="game-container">
  <h1>–£–≥–∞–¥–∞–π –¥—Ä–æ–±—å</h1>
  <p>–Ø –∑–∞–≥–∞–¥–∞–ª–∞ –¥—Ä–æ–±—å. –ü–æ–ø—Ä–æ–±—É–π –µ—ë —É–≥–∞–¥–∞—Ç—å! –í–≤–µ–¥–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ <strong>—á–∏—Å–ª–∏—Ç–µ–ª—å/–∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å</strong>.</p>

  <label for="difficulty">–í—ã–±–µ—Ä–∏ —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:</label>
  <select id="difficulty">
    <option value="easy">–õ–µ–≥–∫–∏–π (–¥–æ 5 –≤ —á–∏—Å–ª–∏—Ç–µ–ª–µ –∏ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª–µ, 8 –ø–æ–ø—ã—Ç–æ–∫)</option>
    <option value="medium" selected>–°—Ä–µ–¥–Ω–∏–π (–¥–æ 8, 6 –ø–æ–ø—ã—Ç–æ–∫)</option>
    <option value="hard">–°–ª–æ–∂–Ω—ã–π (–¥–æ 12, 4 –ø–æ–ø—ã—Ç–æ–∫)</option>
  </select>

  <input type="text" id="guessInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä 3/4" autocomplete="off" />
  <button class="submit-btn" id="submitBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
  
  <div class="message" id="message"></div>
  <div class="hint" id="hint"></div>
  <div class="attempts" id="attempts"></div>
</div>

<script>
  // –ü–æ–¥–≥—Ä—É–∑–∫–∞ —à–∞–ø–∫–∏
  fetch('header.html')
    .then(response => response.text())
    .then(html => {
      document.getElementById('header-placeholder').innerHTML = html;
      // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –±—É—Ä–≥–µ—Ä-–º–µ–Ω—é, –µ—Å–ª–∏ –Ω–∞–¥–æ
      if (typeof initBurgerMenu === 'function') {
        initBurgerMenu();
      }
    })
    .catch(err => console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —à–∞–ø–∫–∏:', err));

  let numerator, denominator, fractionValue;
  let attemptsLeft;
  const guessInput = document.getElementById('guessInput');
  const submitBtn = document.getElementById('submitBtn');
  const messageEl = document.getElementById('message');
  const hintEl = document.getElementById('hint');
  const attemptsEl = document.getElementById('attempts');
  const difficultySelect = document.getElementById('difficulty');

  function gcd(a, b) {
    return b === 0 ? a : gcd(b, a % b);
  }

  function simplifyFraction(n, d) {
    const g = gcd(n, d);
    return [n / g, d / g];
  }

  function generateFraction(level) {
    let maxNum, maxDen;
    switch(level) {
      case 'easy': maxNum = 5; maxDen = 5; attemptsLeft = 8; break;
      case 'medium': maxNum = 8; maxDen = 8; attemptsLeft = 6; break;
      case 'hard': maxNum = 12; maxDen = 12; attemptsLeft = 4; break;
      default: maxNum = 8; maxDen = 8; attemptsLeft = 6;
    }
    do {
      numerator = Math.floor(Math.random() * maxNum) + 1;
      denominator = Math.floor(Math.random() * maxDen) + 1;
    } while (denominator === 0 || numerator > denominator); // –¥—Ä–æ–±—å –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è (<= 1)
    fractionValue = numerator / denominator;
    attemptsEl.textContent = `–ü–æ–ø—ã—Ç–æ–∫ –æ—Å—Ç–∞–ª–æ—Å—å: ${attemptsLeft}`;
    hintEl.textContent = '–ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏.';
    messageEl.textContent = '';
    guessInput.value = '';
    guessInput.disabled = false;
    submitBtn.disabled = false;
    guessInput.focus();
  }

  function generateHint() {
    const hints = [];
    if (fractionValue > 0.75) hints.push("–î—Ä–æ–±—å –±–æ–ª—å—à–µ 3/4.");
    else if (fractionValue > 0.5) hints.push("–î—Ä–æ–±—å –±–æ–ª—å—à–µ 1/2.");
    else if (fractionValue > 0.25) hints.push("–î—Ä–æ–±—å –±–æ–ª—å—à–µ 1/4.");
    else hints.push("–î—Ä–æ–±—å –º–µ–Ω—å—à–µ 1/4.");

    if (numerator > Math.floor(denominator / 2)) hints.push("–ß–∏—Å–ª–∏—Ç–µ–ª—å –±–æ–ª—å—à–µ –ø–æ–ª–æ–≤–∏–Ω—ã –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—è.");
    else hints.push("–ß–∏—Å–ª–∏—Ç–µ–ª—å –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–µ–Ω –ø–æ–ª–æ–≤–∏–Ω–µ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—è.");

    if (denominator % 2 === 0) hints.push("–ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å ‚Äî —á–µ—Ç–Ω–æ–µ —á–∏—Å–ª–æ.");
    else hints.push("–ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å ‚Äî –Ω–µ—á–µ—Ç–Ω–æ–µ —á–∏—Å–ª–æ.");

    return hints[Math.floor(Math.random() * hints.length)];
  }

  function confetti() {
    for (let i = 0; i < 40; i++) {
      const confettiPiece = document.createElement('div');
      confettiPiece.classList.add('confetti-piece');
      confettiPiece.style.left = Math.random() * 100 + '%';
      confettiPiece.style.backgroundColor = `hsl(${Math.random()*360}, 70%, 80%)`;
      confettiPiece.style.animationDelay = (Math.random() * 2) + 's';
      document.querySelector('.game-container').appendChild(confettiPiece);
      setTimeout(() => confettiPiece.remove(), 2200);
    }
  }

  function checkGuess() {
    messageEl.textContent = '';
    messageEl.className = 'message';
    const guess = guessInput.value.trim();
    if (!guess.includes('/')) {
      messageEl.textContent = '–í–≤–µ–¥–∏ –¥—Ä–æ–±—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ —á–∏—Å–ª–∏—Ç–µ–ª—å/–∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å.';
      messageEl.classList.add('error');
      return;
    }

    const parts = guess.split('/');
    const guessNum = parseInt(parts[0], 10);
    const guessDen = parseInt(parts[1], 10);

    if (isNaN(guessNum) || isNaN(guessDen) || guessDen === 0) {
      messageEl.textContent = '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–≤–æ–¥.';
      messageEl.classList.add('error');
      return;
    }

    const [simpNum, simpDen] = simplifyFraction(guessNum, guessDen);

    if (simpNum === numerator && simpDen === denominator) {
      messageEl.textContent = 'üíú –ú–æ–ª–æ–¥–µ—Ü! –¢—ã —É–≥–∞–¥–∞–ª –¥—Ä–æ–±—å!';
      messageEl.classList.add('success');
      submitBtn.disabled = true;
      guessInput.disabled = true;
      hintEl.textContent = '';
      attemptsEl.textContent = '';
      confetti();
    } else {
      attemptsLeft--;
      if (attemptsLeft <= 0) {
        messageEl.textContent = `üò¢ –ü–æ–ø—ã—Ç–∫–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å! –ó–∞–≥–∞–¥–∞–Ω–Ω–∞—è –¥—Ä–æ–±—å: ${numerator}/${denominator}`;
        messageEl.classList.add('error');
        submitBtn.disabled = true;
        guessInput.disabled = true;
        hintEl.textContent = '';
        attemptsEl.textContent = '';
      } else {
        messageEl.textContent = `–ù–µ–≤–µ—Ä–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë!`;
        messageEl.classList.add('error');
        hintEl.textContent = generateHint();
        attemptsEl.textContent = `–ü–æ–ø—ã—Ç–æ–∫ –æ—Å—Ç–∞–ª–æ—Å—å: ${attemptsLeft}`;
      }
    }
    guessInput.value = '';
    guessInput.focus();
  }

  submitBtn.addEventListener('click', checkGuess);
  guessInput.addEventListener('keydown', e => {
    if (e.key === 'Enter') checkGuess();
  });

  difficultySelect.addEventListener('change', () => {
    generateFraction(difficultySelect.value);
  });

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  generateFraction(difficultySelect.value);
</script>

</body>
</html>
